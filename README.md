# yolome

## ====== ca 畸变 =======
#### 训练基础库： 分类齐全的训练集，这里包括6类
    有着异常：dic,trc,r
    无着异常：f,min,ar
    
    其他异常：t - 易位
    恶棍细胞：v - villain cell

    基础训练量：1500-2000图，以低/中剂量阳性为宜
    质控训练：只做1次，无需扩展或追加
            数量以100-300图适合
    恶棍细胞识别：有着>10,可定义为恶棍细胞

#### 扩展库分类：按图像质量风格
    0：长型
    1：中长
    2：中短
    3：短粗
    4：中间分裂
    5：面条
    计数训练：100-200图训练合适，训练mark和6level

#### 增加训练扩展库：
    低剂量阳性扩展库
    高剂量阳性扩展库
    
    训练图质量选择：AIpng或白平衡后的图

    扩展不同场景、剂量
    扩展风格：按6类质量风格（level)区分训练
            训练出2种风格：好图0-2level的合并训练
                        一般图：合并训练0-3类训练
                        其他4-5类，不要训练
    每次追加训练：图像数量以1000-3000之间比较适合

#### 训练注意事项
    每批训练1500-2000，经验数量，不用严格执行
    也可以新增图和基础库图混合，作为新的基础库，这时图会多
    epoch设定：图像数1.5-2.5倍，例如3000图，训练6000-8000次，经验数，实际观察可能需要10000-15000也可能
    total AP：
            图像数量少（0.3-0.5）：计数或质控训练，200图左右，大约1000次
            图像数多，1w图（0.2-0.3），大约训练20000-30000次
                    2k图大约5k次，达到ap=0.2～0.3左右
    训练mark，level：
        缩小图像2倍，1600x1200 to 800x600

    图像一般1600x1200,或1360x1080
    训练建议用多线程，用满gpu显存
    RTX 4070/80/90系列首选
    train : val ： test = 8:1:1,随机生成

    未来部署：RTX 4060ti 8G很快
    cpu i7 最新型号


## ====== MN 微核 ======
#### 训练基础库： 分类齐全的训练集，这里包括4类
    主流：单核彩色40x（国产设备）
    次之：单核黑白40x，20x（少数），（leica，zeiss）
    少见：双核黑白40x（leica）

    基础库数量3000～6000图，训练好图：每图数量50-90细胞，未分化占10-15%（好图）
    使用中低剂量阳性库（阳性率约1%）
    彩色（红蓝色）40x库
    黑白40x库

#### 扩展库分类：按图像质量风格
    扩展以各家客户实际应用数据为采集基地，多中心，定期补充
    后续的权重会大于之前
    临床应用分4-8类
    A 彩色碱性图（蓝色）基础库：
    B 彩色酸性图（红色主流）基础库：
    C 黑白40x基础库（20x可以通过缩小40x重训练，测试ok）
    D 黑白双核（40x）基础库
    每类分2风格：圆形细胞，不规则型细胞（少数）

#### 增加训练扩展库：
    每批次按阳性图（mc占1%的情况）每3000-1w图，逐步增加训练
    多中心图像分类：不同机构，按圆形/不规则分类，按彩色/黑白分类
                合并同类细胞训练，每批次按3000-6000左右为一批
                - 其中每5图，需要至少1个微核，或更多
                - 稀疏图/团聚图：细胞有团聚，或数量10-20母细胞
                - 密集图：总可标记细胞>100
    a 通用库训练：好图：密集：稀疏 = 6：2：2
    b 团聚稀疏图专用库：团聚稀疏图占80%
    c 不单独训练密集图
    
    个性化给各家客户升级

#### 训练注意事项
    以好图为主，或只选好图训练
    稀疏和团聚一定要考虑，按专用库训练


## 总结
    CA质量标准：
      99%检出率
      90%正确分类(人眼屏幕的标准，与显微镜不同）
      假阳性<30%
      假阴性<1%

    MN质量标准：
      99%检出率
      95%正确分类(人眼屏幕的标准，与显微镜不同）
      假阳性<20%
      假阴性<1%

    目前部署第一次追加训练，即可达到标准
    稳定的一致性，大约要第2次追加，达标后，医院对升级可能不太需要，但出论文的需求慢慢会出现


## Contributing

Pull requests are welcome. For major changes, please open an issue first
to discuss what you would like to change.

Please make sure to update tests as appropriate.

## License

[MIT](https://choosealicense.com/licenses/mit/)